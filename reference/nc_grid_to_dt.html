<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Convert a netcdf array to long format as data.table — nc_grid_to_dt • eurocordexr</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Convert a netcdf array to long format as data.table — nc_grid_to_dt"><meta name="description" content="Extracts a variable from netcdf, and returns a
data.table with cell index, date, values, and
optionally: coordinates."><meta property="og:description" content="Extracts a variable from netcdf, and returns a
data.table with cell index, date, values, and
optionally: coordinates."><meta property="og:image" content="https://mitmat.github.io/eurocordexr/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">eurocordexr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.5</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/grids.html">Reading a rotated-pole grid into R</a></li>
    <li><a class="dropdown-item" href="../articles/rotpole-cdo.html">Convert rotated-pole to regular lonlat grid</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/mitmat/eurocordexr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Convert a netcdf array to long format as data.table</h1>
      <small class="dont-index">Source: <a href="https://github.com/mitmat/eurocordexr/blob/v0.2.5/R/nc_grid_to_dt.R" class="external-link"><code>R/nc_grid_to_dt.R</code></a></small>
      <div class="d-none name"><code>nc_grid_to_dt.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Extracts a variable from netcdf, and returns a
<code><a href="https://rdrr.io/pkg/data.table/man/data.table.html" class="external-link">data.table</a></code> with cell index, date, values, and
optionally: coordinates.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">nc_grid_to_dt</span><span class="op">(</span></span>
<span>  <span class="va">filename</span>,</span>
<span>  <span class="va">variable</span>,</span>
<span>  icell_raster_pkg <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  add_xy <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  interpolate_to_standard_calendar <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">date_range</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-filename">filename<a class="anchor" aria-label="anchor" href="#arg-filename"></a></dt>
<dd><p>Complete path to .nc file.</p></dd>


<dt id="arg-variable">variable<a class="anchor" aria-label="anchor" href="#arg-variable"></a></dt>
<dd><p>Name of the variable to extract from <code>filename</code>
(character).</p></dd>


<dt id="arg-icell-raster-pkg">icell_raster_pkg<a class="anchor" aria-label="anchor" href="#arg-icell-raster-pkg"></a></dt>
<dd><p>Boolean, if <code>TRUE</code>, cell indices will be ordered
as if you were extracting the data with the raster package.</p></dd>


<dt id="arg-add-xy">add_xy<a class="anchor" aria-label="anchor" href="#arg-add-xy"></a></dt>
<dd><p>Boolean, if <code>TRUE</code>, adds columns with x and y coordinates.</p></dd>


<dt id="arg-interpolate-to-standard-calendar">interpolate_to_standard_calendar<a class="anchor" aria-label="anchor" href="#arg-interpolate-to-standard-calendar"></a></dt>
<dd><p>Boolean, if <code>TRUE</code> will use
<code><a href="map_non_standard_calendar.html">map_non_standard_calendar</a></code> to interpolate values to a standard
calendar.</p></dd>


<dt id="arg-date-range">date_range<a class="anchor" aria-label="anchor" href="#arg-date-range"></a></dt>
<dd><p>(optional) two-element vector of class Date (min, max),
which will be used to extract only parts of the netcdf file</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Boolean, if <code>TRUE</code>, prints more information.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code><a href="https://rdrr.io/pkg/data.table/man/data.table.html" class="external-link">data.table</a></code> with columns:</p><ul><li><p>date: Date of class <code><a href="https://rdrr.io/r/base/Dates.html" class="external-link">Date</a></code>, if file has
  a standard calendar. Date as character, if it has a non-standard calendar
  (360, noleap) and if <code>interpolate_to_standard_calendar</code> is set to
  <code>FALSE</code>. If <code>interpolate_to_standard_calendar</code> is <code>TRUE</code>,
  it's always of class <code><a href="https://rdrr.io/r/base/Dates.html" class="external-link">Date</a></code>.</p></li>
<li><p>variable: Values, column is
  renamed to input <code>variable</code></p></li>
<li><p>(optional) x,y: Coordinates of
  netcdf dimensions, will be renamed to dimension names found in array named
  after input <code>variable</code></p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Coordinates are usually not put in the result, because it saves space. It is
recommended to merge them after the final operations. The unique cell index
is more efficient. However, if you plan to merge to data extracted with the
raster package (assuming the same grid), then cell indices might differ. Set
<code>icell_raster_pkg</code> to <code>TRUE</code>, to have the same cell indices. Note
that raster and ncdf4 have different concepts of coordinates (cell corner vs.
cell center), so merging based on coordinates can produce arbitrary results
(besides rounding issues).</p>
    </div>
    <div class="section level2">
    <h2 id="warning">Warning<a class="anchor" aria-label="anchor" href="#warning"></a></h2>
    <p>Netcdf files can be huge, so loading everything in memory
  can rapidly crash your R session. Think first about subsetting or
  aggregating (e.g. using CDO:
  <a href="https://code.mpimet.mpg.de/projects/cdo/" class="external-link">https://code.mpimet.mpg.de/projects/cdo/</a>).</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>The raster and terra packages can also open netcdf files and create
  data.frames with <code>raster::as.data.frame</code>
  or <code><a href="https://rspatial.github.io/terra/reference/as.data.frame.html" class="external-link">terra::as.data.frame</a></code>. But, it does
  not handle non-standard calendars, and returns a data.frame, which is
  slower than data.table.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># example data from EURO-CORDEX (cropped for size)</span></span></span>
<span class="r-in"><span><span class="va">fn1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"test1.nc"</span>, package <span class="op">=</span> <span class="st">"eurocordexr"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">nc_grid_to_dt</span><span class="op">(</span><span class="va">fn1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Classes ‘data.table’ and 'data.frame':	25550 obs. of  3 variables:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ icell : int  64 65 66 67 68 69 70 57 58 59 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ date  : Date, format: "1950-01-01" "1950-01-01" ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ tasmin: num  269 269 271 271 272 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - attr(*, ".internal.selfref")=&lt;externalptr&gt; </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Michael Matiu.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

